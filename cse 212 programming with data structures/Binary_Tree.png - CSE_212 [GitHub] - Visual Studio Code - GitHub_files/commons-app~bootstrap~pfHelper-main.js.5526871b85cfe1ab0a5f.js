"use strict";(self.webpackChunkcodespaces_web_client=self.webpackChunkcodespaces_web_client||[]).push([[46],{83730:(e,t,r)=>{function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0});const o=r(98352),i=r(79121);t.RequestType=i.RequestType,t.RequestType0=i.RequestType0,t.RequestType1=i.RequestType1,t.RequestType2=i.RequestType2,t.RequestType3=i.RequestType3,t.RequestType4=i.RequestType4,t.RequestType5=i.RequestType5,t.RequestType6=i.RequestType6,t.RequestType7=i.RequestType7,t.RequestType8=i.RequestType8,t.RequestType9=i.RequestType9,t.ResponseError=i.ResponseError,t.ErrorCodes=i.ErrorCodes,t.NotificationType=i.NotificationType,t.NotificationType0=i.NotificationType0,t.NotificationType1=i.NotificationType1,t.NotificationType2=i.NotificationType2,t.NotificationType3=i.NotificationType3,t.NotificationType4=i.NotificationType4,t.NotificationType5=i.NotificationType5,t.NotificationType6=i.NotificationType6,t.NotificationType7=i.NotificationType7,t.NotificationType8=i.NotificationType8,t.NotificationType9=i.NotificationType9;const s=r(9909);t.MessageReader=s.MessageReader,t.StreamMessageReader=s.StreamMessageReader,t.IPCMessageReader=s.IPCMessageReader,t.SocketMessageReader=s.SocketMessageReader;const a=r(35841);t.MessageWriter=a.MessageWriter,t.StreamMessageWriter=a.StreamMessageWriter,t.IPCMessageWriter=a.IPCMessageWriter,t.SocketMessageWriter=a.SocketMessageWriter;const c=r(16559);t.Disposable=c.Disposable,t.Event=c.Event,t.Emitter=c.Emitter;const l=r(79336);t.CancellationTokenSource=l.CancellationTokenSource,t.CancellationToken=l.CancellationToken;const d=r(22299);var f,u,p,m,g,h,y;n(r(17339)),n(r(63105)),function(e){e.type=new i.NotificationType("$/cancelRequest")}(f||(f={})),t.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}}),function(e){e[e.Off=0]="Off",e[e.Messages=1]="Messages",e[e.Verbose=2]="Verbose"}(u=t.Trace||(t.Trace={})),function(e){e.fromString=function(t){switch(t=t.toLowerCase()){case"off":default:return e.Off;case"messages":return e.Messages;case"verbose":return e.Verbose}},e.toString=function(t){switch(t){case e.Off:return"off";case e.Messages:return"messages";case e.Verbose:return"verbose";default:return"off"}}}(u=t.Trace||(t.Trace={})),function(e){e.Text="text",e.JSON="json"}(t.TraceFormat||(t.TraceFormat={})),function(e){e.fromString=function(t){return"json"===(t=t.toLowerCase())?e.JSON:e.Text}}(p=t.TraceFormat||(t.TraceFormat={})),function(e){e.type=new i.NotificationType("$/setTraceNotification")}(m=t.SetTraceNotification||(t.SetTraceNotification={})),function(e){e.type=new i.NotificationType("$/logTraceNotification")}(g=t.LogTraceNotification||(t.LogTraceNotification={})),function(e){e[e.Closed=1]="Closed",e[e.Disposed=2]="Disposed",e[e.AlreadyListening=3]="AlreadyListening"}(h=t.ConnectionErrors||(t.ConnectionErrors={}));class T extends Error{constructor(e,t){super(t),this.code=e,Object.setPrototypeOf(this,T.prototype)}}function w(e,t,r,n){let s=0,a=0,w=0;const v="2.0";let R,N,S,E,C=Object.create(null),b=Object.create(null),O=new d.LinkedMap,$=Object.create(null),q=Object.create(null),M=u.Off,k=p.Text,j=y.New,P=new c.Emitter,x=new c.Emitter,L=new c.Emitter,D=new c.Emitter;function J(e){return"req-"+e.toString()}function V(e,t){var r;i.isRequestMessage(t)?e.set(J(t.id),t):i.isResponseMessage(t)?e.set(null===(r=t.id)?"res-unknown-"+(++w).toString():"res-"+r.toString(),t):e.set("not-"+(++a).toString(),t)}function W(e){}function I(){return j===y.Listening}function F(){return j===y.Closed}function U(){return j===y.Disposed}function _(){j!==y.New&&j!==y.Listening||(j=y.Closed,x.fire(void 0))}function z(){S||0===O.size||(S=setImmediate((()=>{S=void 0,function(){if(0===O.size)return;let e=O.shift();try{i.isRequestMessage(e)?function(e){if(U())return;function r(r,n,o){let s={jsonrpc:v,id:e.id};r instanceof i.ResponseError?s.error=r.toJson():s.result=void 0===r?null:r,B(s,n,o),t.write(s)}function n(r,n,o){let i={jsonrpc:v,id:e.id,error:r.toJson()};B(i,n,o),t.write(i)}function s(r,n,o){void 0===r&&(r=null);let i={jsonrpc:v,id:e.id,result:r};B(i,n,o),t.write(i)}!function(e){if(M===u.Off||!E)return;if(k===p.Text){let t;M===u.Verbose&&e.params&&(t=`Params: ${JSON.stringify(e.params,null,4)}\n\n`),E.log(`Received request '${e.method} - (${e.id})'.`,t)}else G("receive-request",e)}(e);let a,c,d=C[e.method];d&&(a=d.type,c=d.handler);let f=Date.now();if(c||R){let t=new l.CancellationTokenSource,d=String(e.id);q[d]=t;try{let l;l=void 0===e.params||void 0!==a&&0===a.numberOfParams?c?c(t.token):R(e.method,t.token):o.array(e.params)&&(void 0===a||a.numberOfParams>1)?c?c(...e.params,t.token):R(e.method,...e.params,t.token):c?c(e.params,t.token):R(e.method,e.params,t.token);let u=l;l?u.then?u.then((t=>{delete q[d],r(t,e.method,f)}),(t=>{delete q[d],t instanceof i.ResponseError?n(t,e.method,f):t&&o.string(t.message)?n(new i.ResponseError(i.ErrorCodes.InternalError,`Request ${e.method} failed with message: ${t.message}`),e.method,f):n(new i.ResponseError(i.ErrorCodes.InternalError,`Request ${e.method} failed unexpectedly without providing any details.`),e.method,f)})):(delete q[d],r(l,e.method,f)):(delete q[d],s(l,e.method,f))}catch(t){delete q[d],t instanceof i.ResponseError?r(t,e.method,f):t&&o.string(t.message)?n(new i.ResponseError(i.ErrorCodes.InternalError,`Request ${e.method} failed with message: ${t.message}`),e.method,f):n(new i.ResponseError(i.ErrorCodes.InternalError,`Request ${e.method} failed unexpectedly without providing any details.`),e.method,f)}}else n(new i.ResponseError(i.ErrorCodes.MethodNotFound,`Unhandled method ${e.method}`),e.method,f)}(e):i.isNotificationMessage(e)?function(e){if(U())return;let t,n;if(e.method===f.type.method)n=e=>{let t=e.id,r=q[String(t)];r&&r.cancel()};else{let r=b[e.method];r&&(n=r.handler,t=r.type)}if(n||N)try{!function(e){if(M===u.Off||!E||e.method===g.type.method)return;if(k===p.Text){let t;M===u.Verbose&&(t=e.params?`Params: ${JSON.stringify(e.params,null,4)}\n\n`:"No parameters provided.\n\n"),E.log(`Received notification '${e.method}'.`,t)}else G("receive-notification",e)}(e),void 0===e.params||void 0!==t&&0===t.numberOfParams?n?n():N(e.method):o.array(e.params)&&(void 0===t||t.numberOfParams>1)?n?n(...e.params):N(e.method,...e.params):n?n(e.params):N(e.method,e.params)}catch(t){t.message?r.error(`Notification handler '${e.method}' failed with message: ${t.message}`):r.error(`Notification handler '${e.method}' failed unexpectedly.`)}else L.fire(e)}(e):i.isResponseMessage(e)?function(e){if(U())return;if(null===e.id)e.error?r.error(`Received response message without id: Error is: \n${JSON.stringify(e.error,void 0,4)}`):r.error("Received response message without id. No further error information provided.");else{let t=String(e.id),n=$[t];if(function(e,t){if(M===u.Off||!E)return;if(k===p.Text){let r;if(M===u.Verbose&&(e.error&&e.error.data?r=`Error data: ${JSON.stringify(e.error.data,null,4)}\n\n`:e.result?r=`Result: ${JSON.stringify(e.result,null,4)}\n\n`:void 0===e.error&&(r="No result returned.\n\n")),t){let n=e.error?` Request failed: ${e.error.message} (${e.error.code}).`:"";E.log(`Received response '${t.method} - (${e.id})' in ${Date.now()-t.timerStart}ms.${n}`,r)}else E.log(`Received response ${e.id} without active response promise.`,r)}else G("receive-response",e)}(e,n),n){delete $[t];try{if(e.error){let t=e.error;n.reject(new i.ResponseError(t.code,t.message,t.data))}else{if(void 0===e.result)throw new Error("Should never happen.");n.resolve(e.result)}}catch(e){e.message?r.error(`Response handler '${n.method}' failed with message: ${e.message}`):r.error(`Response handler '${n.method}' failed unexpectedly.`)}}}}(e):function(e){if(!e)return void r.error("Received empty message.");r.error(`Received message which is neither a response nor a notification message:\n${JSON.stringify(e,null,4)}`);let t=e;if(o.string(t.id)||o.number(t.id)){let e=String(t.id),r=$[e];r&&r.reject(new Error("The received response has neither a result nor an error property."))}}(e)}finally{z()}}()})))}e.onClose(_),e.onError((function(e){P.fire([e,void 0,void 0])})),t.onClose(_),t.onError((function(e){P.fire(e)}));let A=e=>{try{if(i.isNotificationMessage(e)&&e.method===f.type.method){let r=J(e.params.id),o=O.get(r);if(i.isRequestMessage(o)){let i=n&&n.cancelUndispatched?n.cancelUndispatched(o,W):void 0;if(i&&(void 0!==i.error||void 0!==i.result))return O.delete(r),i.id=o.id,B(i,e.method,Date.now()),void t.write(i)}}V(O,e)}finally{z()}};function B(e,t,r){if(M!==u.Off&&E)if(k===p.Text){let n;M===u.Verbose&&(e.error&&e.error.data?n=`Error data: ${JSON.stringify(e.error.data,null,4)}\n\n`:e.result?n=`Result: ${JSON.stringify(e.result,null,4)}\n\n`:void 0===e.error&&(n="No result returned.\n\n")),E.log(`Sending response '${t} - (${e.id})'. Processing request took ${Date.now()-r}ms`,n)}else G("send-response",e)}function G(e,t){if(!E||M===u.Off)return;const r={isLSPMessage:!0,type:e,message:t,timestamp:Date.now()};E.log(r)}function H(){if(F())throw new T(h.Closed,"Connection is closed.");if(U())throw new T(h.Disposed,"Connection is disposed.")}function K(e){return void 0===e?null:e}function Q(e,t){let r,n=e.numberOfParams;switch(n){case 0:r=null;break;case 1:r=K(t[0]);break;default:r=[];for(let e=0;e<t.length&&e<n;e++)r.push(K(t[e]));if(t.length<n)for(let e=t.length;e<n;e++)r.push(null)}return r}let X={sendNotification:(e,...r)=>{let n,i;if(H(),o.string(e))switch(n=e,r.length){case 0:i=null;break;case 1:i=r[0];break;default:i=r}else n=e.method,i=Q(e,r);let s={jsonrpc:v,method:n,params:i};!function(e){if(M!==u.Off&&E)if(k===p.Text){let t;M===u.Verbose&&(t=e.params?`Params: ${JSON.stringify(e.params,null,4)}\n\n`:"No parameters provided.\n\n"),E.log(`Sending notification '${e.method}'.`,t)}else G("send-notification",e)}(s),t.write(s)},onNotification:(e,t)=>{H(),o.func(e)?N=e:t&&(o.string(e)?b[e]={type:void 0,handler:t}:b[e.method]={type:e,handler:t})},sendRequest:(e,...r)=>{let n,a,c;if(H(),function(){if(!I())throw new Error("Call listen() first.")}(),o.string(e))switch(n=e,r.length){case 0:a=null;break;case 1:l.CancellationToken.is(r[0])?(a=null,c=r[0]):a=K(r[0]);break;default:const e=r.length-1;l.CancellationToken.is(r[e])?(c=r[e],a=2===r.length?K(r[0]):r.slice(0,e).map((e=>K(e)))):a=r.map((e=>K(e)))}else{n=e.method,a=Q(e,r);let t=e.numberOfParams;c=l.CancellationToken.is(r[t])?r[t]:void 0}let d=s++,m=new Promise(((e,r)=>{let o={jsonrpc:v,id:d,method:n,params:a},s={method:n,timerStart:Date.now(),resolve:e,reject:r};!function(e){if(M!==u.Off&&E)if(k===p.Text){let t;M===u.Verbose&&e.params&&(t=`Params: ${JSON.stringify(e.params,null,4)}\n\n`),E.log(`Sending request '${e.method} - (${e.id})'.`,t)}else G("send-request",e)}(o);try{t.write(o)}catch(e){s.reject(new i.ResponseError(i.ErrorCodes.MessageWriteError,e.message?e.message:"Unknown reason")),s=null}s&&($[String(d)]=s)}));return c&&c.onCancellationRequested((()=>{X.sendNotification(f.type,{id:d})})),m},onRequest:(e,t)=>{H(),o.func(e)?R=e:t&&(o.string(e)?C[e]={type:void 0,handler:t}:C[e.method]={type:e,handler:t})},trace:(e,t,r)=>{let n=!1,i=p.Text;void 0!==r&&(o.boolean(r)?n=r:(n=r.sendNotification||!1,i=r.traceFormat||p.Text)),M=e,k=i,E=M===u.Off?void 0:t,!n||F()||U()||X.sendNotification(m.type,{value:u.toString(e)})},onError:P.event,onClose:x.event,onUnhandledNotification:L.event,onDispose:D.event,dispose:()=>{if(U())return;j=y.Disposed,D.fire(void 0);let r=new Error("Connection got disposed.");Object.keys($).forEach((e=>{$[e].reject(r)})),$=Object.create(null),q=Object.create(null),O=new d.LinkedMap,o.func(t.dispose)&&t.dispose(),o.func(e.dispose)&&e.dispose()},listen:()=>{H(),function(){if(I())throw new T(h.AlreadyListening,"Connection is already listening")}(),j=y.Listening,e.listen(A)},inspect:()=>{console.log("inspect")}};return X.onNotification(g.type,(e=>{M!==u.Off&&E&&E.log(e.message,M===u.Verbose?e.verbose:void 0)})),X}t.ConnectionError=T,function(e){e.is=function(e){let t=e;return t&&o.func(t.cancelUndispatched)}}(t.ConnectionStrategy||(t.ConnectionStrategy={})),function(e){e[e.New=1]="New",e[e.Listening=2]="Listening",e[e.Closed=3]="Closed",e[e.Disposed=4]="Disposed"}(y||(y={})),t.createMessageConnection=function(e,r,n,o){n||(n=t.NullLogger);let i=void 0!==(c=e).listen&&void 0===c.read?e:new s.StreamMessageReader(e);var c;let l=function(e){return void 0!==e.write&&void 0===e.end}(r)?r:new a.StreamMessageWriter(r);return w(i,l,n,o)}}}]);